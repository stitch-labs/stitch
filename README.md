# stitch

*Stitch is an Incredibly fast EVM runtime emulator, bundler, test runner, and package manager â€“ all in one. It ships as a single executable called `stitch`.*

Stitch is not yet production-ready. In particular, the protocol and data file formats may change and [might not be compatible across different commits](https://github.com/stitch-labs/stitch/issues/1), while we fine-tune the format ahead of release.

The production version of **Stitch is not under active development**.


## Quickstart

On macOS/Linux:

```console
git clone https://github.com/stitch-labs/stitch; cd stitch; zig build; zig run src/stitch.zig;
```

â€‹â€‹The `stitch` command-line tool also implements a EVM runtime emulator, bundler, test runner, and github based package manager. Instead of manually linking for development, you only need `stitch`. Stitch's built-in tools are significantly faster than existing options and usable in existing ethereum projects with little to no changes.

```console
ðŸš€ What is Stitch?

ðŸ”µ Stitch is under active development. Use it to speed up
   your development workflows or run simpler production
   code in resource-constrained environments like localhost.
   We're working on more complete runtime compatibility and 
   integration with existing frameworks like foundry and hardhat.
   Join the [Discord](https://stitch-labs.sh/discord) and watch
   the [GitHub repository](https://github.com/stitch-labs/stitch)
   to keep tabs on future releases.

ðŸ§µ Stitch is an all-in-one toolkit for EVM Development.
   It ships as a single executable called `stitch`.

   At its core is the _Stitch runtime_, a fast EVM client
   designed as an EVM runtime written in Zig and powered by 
   StitchScriptCore under the hood,
   dramatically reducing startup times and memory usage.

ðŸ“¦ The `stitch` command-line tool also implements a test runner,
   script runner, and a light ethereum client. a novel package
   manager. Instead of 100 dev tools for development, you only
   need `stitch`. Stitch's built-in tools are significantly
   faster than existing options and usable in existing ethereum
   projects with little to no changes.

Usage: stitch [command] [options]

Commands:
 
  spec-abi                     Generates Zig bindings for an ABI specification .json
  bytecode-bindings-abi        Generates the EVM bytecode bindings for an ABI specification .json

General Options:

  -h, --help       Print command-specific usage

Debug Commands:

  dump-bindings                Dump a file containing the cached EVM bytecode bindings
```

Lookout for the executable you should be using until bootstraping is supported, it will look something like this.
```bash
debug: Use /Users/christopher.bradley/.cache/zig/o/1f871e4643d84385e6d8a500bf67b162/stitch instead of the (stitch) command
```

Working Features:
  - bytecode-bindings-abi (Will save under `/src/codegen/abi/bindings/bytecode/<Filename>`)
    ```console
    f((uint256,uint256[],(uint256,uint256)[]),(uint256,uint256),uint256)
    ```
  - spec-abi (Will save under `/src/codegen/abi/bindings`)
    ```zig
    //This file is auto-generated by tools/gen_abi_spec.zig
    const Version = @import("std").SemanticVersion;
    pub const AbiFunctionType = enum(u8) {
        function = 0x0,
    };
    pub const AbiComponentType = enum(u8) {
        tuple = 0x10,
        uint256 = 0x11,
    };
    const AbiFunction = struct {
        name: []const u8,
        type: AbiFunctionType,
        inputs: []AbiComponent,
        outputs: []AbiComponent,
    };
    const AbiComponent = struct {
        name: []const u8,
        type: AbiComponentType,
        components: []AbiComponent,
    };
    ```

Partially Working:
- `zig test src/tools/contract/lexer.zig`

Input (located `/example/stitch_abi.json`)
```solidity
// SPDX-License-Identifier: GPL-3.0
pragma solidity ^0.8.0;
pragma experimental ABIEncoderV2;

contract Example {
    struct S { uint a; uint[] b; T[] c; }
}
```


Output
```bash
Test [1/6] test.Lexer... 
(( SPDX-License-Identifier: GPL-3.0,  SPDX-License-Identifier: GPL-3.0), (4, 4))
((pragma, pragma), (23, 23))
((solidity, solidity), (26, 26))
((^, ^), (19, 19))
((0, 0), (3, 3))
((., .), (20, 20))
((8, 8), (3, 3))
((., .), (20, 20))
((0, 0), (3, 3))
((;, ;), (14, 14))
((pragma, pragma), (23, 23))
((experimental, experimental), (28, 28))
((ABIEncoderV2, ABIEncoderV2), (2, 2))
((;, ;), (14, 14))
((struct, struct), (25, 25))
((S, S), (2, 2))
(({, {), (17, 17))
((uint, uint), (29, 29))
((a, a), (2, 2))
((;, ;), (14, 14))
((uint, uint), (29, 29))
(([, [), (21, 21))
((], ]), (22, 22))
((b, b), (2, 2))
((;, ;), (14, 14))
((T, T), (2, 2))
(([, [), (21, 21))
((], ]), (22, 22))
((c, c), (2, 2))
((;, ;), (14, 14))
((}, }), (18, 18))
```
